{"version":3,"sources":["../../../src/js/register.js"],"names":[],"mappings":"AAAA,YAAY,CAAC;;;;;;IAEP,YAAY;AACd,aADE,YAAY,GACA;;;8BADZ,YAAY;;AAEV,SAAC,CAAC,YAAY,CAAC,CAAC,EAAE,CAAC,OAAO,EAAE,UAAC,KAAK,EAAK;AAAE,kBAAK,WAAW,CAAC,KAAK,CAAC,CAAC;SAAE,CAAC,CAAC;AACrE,SAAC,CAAC,WAAW,CAAC,CAAC,EAAE,CAAC,MAAM,EAAE,IAAI,CAAC,aAAa,CAAC,CAAC;AAC9C,SAAC,CAAC,WAAW,CAAC,CAAC,EAAE,CAAC,OAAO,EAAE,IAAI,CAAC,qBAAqB,CAAC,CAAC;AACvD,SAAC,CAAC,oBAAoB,CAAC,CAAC,EAAE,CAAC,OAAO,EAAE,YAAM;AAAE,kBAAK,eAAe,EAAE,CAAC;SAAE,CAAC;;;AAAC,AAGvE,YAAI,CAAC,YAAY,GAAG,CAAC,GAAG,EAAE,GAAG,EAAE,GAAG,CAAC,CAAC;AACpC,YAAI,CAAC,WAAW,GAAG,EAAE,CAAC;AACtB,YAAI,CAAC,WAAW,GAAG,EAAE,CAAC;AACtB,YAAI,CAAC,iBAAiB,GAAG,EAAE,CAAC;AAC5B,YAAI,CAAC,eAAe,EAAE,CAAC;KAC1B;;iBAbC,YAAY;;oCAeF,CAAC,EAAE;AACX,aAAC,CAAC,cAAc,EAAE,CAAC;AACnB,gBAAI,CAAC,YAAY,EAAE,CAAC;AACpB,gBAAI,CAAC,aAAa,EAAE,CAAC;AACrB,aAAC,CAAC,qBAAqB,CAAC,CAAC,IAAI,EAAE,CAAC;AAChC,gBAAI,MAAM,GAAG,IAAI,CAAC,UAAU,EAAE,CAAC;AAC/B,gBAAI,MAAM,CAAC,MAAM,KAAK,CAAC,EAAE;AACrB,oBAAI,CAAC,YAAY,EAAE,CAAC;aACvB,MACI;AACD,oBAAI,CAAC,SAAS,CAAC,MAAM,CAAC,CAAC;aAC1B;SACJ;;;wCAEe;AACZ,gBAAI,QAAQ,GAAG,CAAC,CAAC,WAAW,CAAC,CAAC,GAAG,EAAE,CAAC;AACpC,gBAAI,QAAQ,CAAC,MAAM,KAAK,CAAC,EAAE;AACvB,uBAAO;aACV;;AAED,aAAC,CAAC,IAAI,CAAC;AACH,oBAAI,EAAE,MAAM;AACZ,mBAAG,EAAE,CAAC,CAAC,mBAAmB,CAAC,CAAC,IAAI,CAAC,QAAQ,CAAC;AAC1C,oBAAI,EAAE;AACF,wBAAI,EAAE,eAAe;AACrB,4BAAQ,EAAE,QAAQ;iBACrB;AACD,uBAAO,EAAE,iBAAC,QAAQ,EAAK;AACnB,wBAAI,CAAC,QAAQ,CAAC,OAAO,EAAE;AACnB,yBAAC,CAAC,WAAW,CAAC,CAAC,QAAQ,CAAC,sBAAsB,CAAC,CAChC,WAAW,CAAC,qBAAqB,CAAC,CAAC;AAClD,yBAAC,CAAC,iBAAiB,CAAC,CAAC,QAAQ,CAAC,aAAa,CAAC,CACvB,WAAW,CAAC,YAAY,CAAC,CAAC;qBAClD,MACI;AACD,yBAAC,CAAC,WAAW,CAAC,CAAC,QAAQ,CAAC,qBAAqB,CAAC,CAC/B,WAAW,CAAC,sBAAsB,CAAC,CAAC;AACnD,yBAAC,CAAC,iBAAiB,CAAC,CAAC,QAAQ,CAAC,YAAY,CAAC,CACtB,WAAW,CAAC,aAAa,CAAC,CAAC;qBACnD;iBACJ;aACJ,CAAC,CAAC;SACN;;;gDAEuB;AACpB,gBAAI,QAAQ,GAAG,CAAC,CAAC,WAAW,CAAC,CAAC,GAAG,EAAE,CAAC;AACpC,gBAAI,gBAAgB,GAAG,CAAC,CAAC;AACzB,gBAAI,mBAAmB,GAAG,GAAG,GAAG,CAAC,CAAC;AAClC,gBAAI,QAAQ,CAAC,MAAM,IAAI,CAAC,EAAE;AACtB,gCAAgB,IAAI,mBAAmB,CAAC;aAC3C;;AAED,gBAAI,QAAQ,KAAK,QAAQ,CAAC,WAAW,EAAE,EAAE;AACrC,gCAAgB,IAAI,mBAAmB,CAAC;aAC3C;;;AAAA,AAGD,gBAAI,iBAAiB,GAAG,iCAAiC,CAAC;AAC1D,gBAAI,cAAc,GAAG,KAAK,CAAC;AAC3B,iBAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,QAAQ,CAAC,MAAM,EAAE,CAAC,EAAE,EAAE;AACtC,oBAAI,iBAAiB,CAAC,OAAO,CAAC,QAAQ,CAAC,CAAC,CAAC,CAAC,KAAK,CAAC,CAAC,EAAE;AAC/C,kCAAc,GAAG,IAAI,CAAC;AACtB,0BAAM;iBACT;aACJ;;AAED,gBAAI,cAAc,EAAE;AAChB,gCAAgB,IAAI,mBAAmB,CAAC;aAC3C;AACD,aAAC,CAAC,uBAAuB,CAAC,CAAC,IAAI,CAAC,OAAO,EAAE,gBAAgB,CAAC,CAAC;SAC9D;;;0CAEiB;AACd,gBAAI,QAAQ,GAAG,IAAI,CAAC,KAAK,CAAC,AAAC,IAAI,CAAC,MAAM,EAAE,GAAG,CAAC,GAAI,CAAC,CAAC,CAAC;AACnD,oBAAQ,EAAE,CAAC;AACX,gBAAI,CAAC,iBAAiB,GAAG,IAAI,CAAC,YAAY,CAAC,QAAQ,CAAC,CAAC;AACrD,gBAAI,CAAC,WAAW,GAAG,IAAI,CAAC,KAAK,CAAC,AAAC,IAAI,CAAC,MAAM,EAAE,GAAG,EAAE,GAAI,CAAC,CAAC,CAAC;AACxD,gBAAI,CAAC,WAAW,GAAG,IAAI,CAAC,KAAK,CAAC,AAAC,IAAI,CAAC,MAAM,EAAE,GAAG,EAAE,GAAI,CAAC,CAAC,CAAC;AACxD,gBAAI,IAAI,CAAC,iBAAiB,KAAK,GAAG,EAAE;;AAEhC,oBAAI,IAAI,CAAC,WAAW,GAAG,IAAI,CAAC,WAAW,EAAE;AACrC,wBAAI,GAAG,GAAG,IAAI,CAAC,WAAW,CAAC;AAC3B,wBAAI,CAAC,WAAW,GAAG,IAAI,CAAC,WAAW,CAAC;AACpC,wBAAI,CAAC,WAAW,GAAG,GAAG,CAAC;iBAC1B;aACJ;;;AAAA,AAGD,aAAC,CAAC,qBAAqB,CAAC,CAAC,IAAI,CAAC,IAAI,CAAC,WAAW,CAAC,CAAC;AAChD,aAAC,CAAC,YAAY,CAAC,CAAC,IAAI,CAAC,IAAI,CAAC,iBAAiB,CAAC,CAAC;AAC7C,aAAC,CAAC,sBAAsB,CAAC,CAAC,IAAI,CAAC,IAAI,CAAC,WAAW,CAAC,CAAC;SACpD;;;;;;qCAGY;AACT,gBAAI,QAAQ,GAAG,CAAC,CAAC,WAAW,CAAC,CAAC,GAAG,EAAE,CAAC;AACpC,gBAAI,KAAK,GAAG,CAAC,CAAC,QAAQ,CAAC,CAAC,GAAG,EAAE,CAAC;AAC9B,gBAAI,QAAQ,GAAG,CAAC,CAAC,WAAW,CAAC,CAAC,GAAG,EAAE,CAAC;AACpC,gBAAI,SAAS,GAAG,CAAC,CAAC,YAAY,CAAC,CAAC,GAAG,EAAE,CAAC;AACtC,gBAAI,MAAM,GAAG,EAAE,CAAC;AAChB,gBAAI,QAAQ,CAAC,MAAM,KAAK,CAAC,EAAE;AACvB,sBAAM,CAAC,IAAI,CAAC,iBAAiB,CAAC,CAAC;aAClC;;AAED,gBAAI,QAAQ,CAAC,MAAM,KAAK,CAAC,IAAI,QAAQ,KAAK,SAAS,EAAE;AACjD,sBAAM,CAAC,IAAI,CAAC,iBAAiB,CAAC,CAAC;aAClC;;AAED,gBAAI,SAAS,GAAG,oFAAoF,CAAC;AACrG,gBAAI,KAAK,CAAC,MAAM,KAAK,CAAC,IAAI,CAAC,SAAS,CAAC,IAAI,CAAC,KAAK,CAAC,EAAE;AAC9C,sBAAM,CAAC,IAAI,CAAC,cAAc,CAAC,CAAC;aAC/B;;AAED,gBAAI,CAAC,IAAI,CAAC,mBAAmB,EAAE,EAAE;AAC7B,sBAAM,CAAC,IAAI,CAAC,gBAAgB,CAAC,CAAC;aACjC;AACD,mBAAO,MAAM,CAAC;SACjB;;;8CAEqB;AAClB,gBAAI,UAAU,GAAG,CAAC,CAAC,eAAe,CAAC,CAAC,GAAG,EAAE,CAAC;AAC1C,gBAAI,UAAU,CAAC,MAAM,KAAK,CAAC,EAAE;AACzB,uBAAO,KAAK,CAAC;aAChB;;AAED,sBAAU,GAAG,QAAQ,CAAC,UAAU,EAAE,EAAE,CAAC,CAAC;AACtC,gBAAI,KAAK,CAAC,UAAU,CAAC,EAAE;AACnB,uBAAO,KAAK,CAAC;aAChB;;AAED,gBAAI,MAAM,GAAG,CAAC,CAAC;AACf,oBAAQ,IAAI,CAAC,iBAAiB;AAC1B,qBAAK,GAAG;AACJ,0BAAM,GAAG,IAAI,CAAC,WAAW,GAAG,IAAI,CAAC,WAAW,CAAC;AAC7C,0BAAM;AAAA,AACV,qBAAK,GAAG;AACJ,0BAAM,GAAG,IAAI,CAAC,WAAW,GAAG,IAAI,CAAC,WAAW,CAAC;AAC7C,0BAAM;AAAA,AACV,qBAAK,GAAG;AACJ,0BAAM,GAAG,IAAI,CAAC,WAAW,GAAG,IAAI,CAAC,WAAW,CAAC;AAC7C,0BAAM;AAAA,AACV;AACI,0BAAM,GAAG,IAAI,CAAC,WAAW,GAAG,IAAI,CAAC,WAAW,CAAC;AAC7C,0BAAM;AAAA,aACb;;AAED,mBAAO,MAAM,KAAK,UAAU,CAAC;SAChC;;;uCAEc;AACX,gBAAI,QAAQ,GAAG,IAAI,CAAC,YAAY,EAAE,CAAC;AACnC,aAAC,CAAC,YAAY,CAAC,CAAC,QAAQ,CAAC,UAAU,CAAC,CAAC;AACrC,aAAC,CAAC,aAAa,CAAC,CAAC,IAAI,EAAE,CAAC;AACxB,aAAC,CAAC,IAAI,CAAC;AACH,oBAAI,EAAE,MAAM;AACZ,mBAAG,EAAE,CAAC,CAAC,mBAAmB,CAAC,CAAC,IAAI,CAAC,QAAQ,CAAC;AAC1C,oBAAI,EAAE,QAAQ;AACd,uBAAO,EAAE,IAAI,CAAC,gBAAgB;AAC9B,qBAAK,EAAE,IAAI,CAAC,cAAc;aAC7B,CAAC,CAAC;SACN;;;yCAEgB,QAAQ,EAAE;AACvB,aAAC,CAAC,aAAa,CAAC,CAAC,IAAI,EAAE,CAAC;AACxB,gBAAI,QAAQ,CAAC,MAAM,EAAE;AACjB,iBAAC,CAAC,WAAW,CAAC,CAAC,MAAM,EAAE,CAAC;AACxB,iBAAC,CAAC,uBAAuB,CAAC,CAAC,IAAI,EAAE,CAAC;aACrC,MACI;AACD,iBAAC,CAAC,YAAY,CAAC,CAAC,WAAW,CAAC,UAAU,CAAC,CAAC;AACxC,iBAAC,CAAC,qBAAqB,CAAC,CAAC,IAAI,EAAE,CAAC;aACnC;SACJ;;;yCAEgB;AACb,aAAC,CAAC,aAAa,CAAC,CAAC,IAAI,EAAE,CAAC;AACxB,aAAC,CAAC,YAAY,CAAC,CAAC,WAAW,CAAC,UAAU,CAAC,CAAC;AACxC,aAAC,CAAC,qBAAqB,CAAC,CAAC,IAAI,EAAE,CAAC;SACnC;;;uCAEc;AACX,mBAAO;AACH,oBAAI,EAAE,cAAc;AACpB,qBAAK,EAAE,CAAC,CAAC,WAAW,CAAC,CAAC,GAAG,EAAE;AAC3B,qBAAK,EAAE,CAAC,CAAC,QAAQ,CAAC,CAAC,GAAG,EAAE;AACxB,wBAAQ,EAAE,CAAC,CAAC,WAAW,CAAC,CAAC,GAAG,EAAE;aACjC,CAAC;SACL;;;kCAES,QAAQ,EAAE;AAChB,aAAC,CAAC,QAAQ,CAAC,CAAC,IAAI,CAAC,UAAC,CAAC,EAAK;AACpB,iBAAC,CAAC,QAAQ,CAAC,CAAC,CAAC,CAAC,CAAC,QAAQ,CAAC,YAAY,CAAC,CAAC;AACtC,iBAAC,CAAC,QAAQ,CAAC,CAAC,CAAC,CAAC,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC,QAAQ,CAAC,qBAAqB,CAAC,CAAC;aAChE,CAAC,CAAC;SACN;;;uCAEc;AACX,aAAC,CAAC,wBAAwB,CAAC,CAAC,WAAW,CAAC,YAAY,CAAC,CAAC;AACtD,aAAC,CAAC,yBAAyB,CAAC,CAAC,WAAW,CAAC,aAAa,CAAC,CAAC;AACxD,aAAC,CAAC,4BAA4B,CAAC,CAAC,WAAW,CAAC,qBAAqB,CAAC,CAAC;AACnE,aAAC,CAAC,6BAA6B,CAAC,CAAC,WAAW,CAAC,sBAAsB,CAAC,CAAC;SACxE;;;WAxNC,YAAY;;;AA2NlB,CAAC,CAAC,QAAQ,CAAC,CAAC,KAAK,CAAC,YAAM;AACpB,QAAI,YAAY,EAAE,CAAC;CACtB,CAAC,CAAC","file":"register.js","sourcesContent":["'use strict';\r\n\r\nclass Registration {\r\n    constructor() {\r\n        $('#btnSubmit').on('click', (event) => { this.clickSubmit(event); });\r\n        $('#username').on('blur', this.checkUsername);\r\n        $('#password').on('keyup', this.checkPasswordStrength);\r\n        $('#btnRefreshCaptcha').on('click', () => { this.generateCaptcha(); });\r\n\r\n        // Captcha\r\n        this.tabOpCaptcha = ['+', '-', 'x'];\r\n        this.fNumCaptcha = '';\r\n        this.sNumCaptcha = '';\r\n        this.selectedOpCaptcha = '';\r\n        this.generateCaptcha();\r\n    }\r\n\r\n    clickSubmit(e) {\r\n        e.preventDefault();\r\n        this._removeError();\r\n        this.checkUsername();\r\n        $('#registerAlertError').hide();\r\n        let tabErr = this._validForm();\r\n        if (tabErr.length === 0) {\r\n            this._sendRequest();\r\n        }\r\n        else {\r\n            this._addError(tabErr);\r\n        }\r\n    }\r\n\r\n    checkUsername() {\r\n        let userName = $('#username').val();\r\n        if (userName.length === 0) {\r\n            return;\r\n        }\r\n\r\n        $.ajax({\r\n            type: 'POST',\r\n            url: $('#registrationForm').attr('action'),\r\n            data: {\r\n                type: 'checkUsername',\r\n                username: userName\r\n            },\r\n            success: (response) => {\r\n                if (!response.isExist) {\r\n                    $('#username').addClass('form-control-success')\r\n                                  .removeClass('form-control-danger');\r\n                    $('#formGpUsername').addClass('has-success')\r\n                                        .removeClass('has-danger');\r\n                }\r\n                else {\r\n                    $('#username').addClass('form-control-danger')\r\n                                  .removeClass('form-control-success');\r\n                    $('#formGpUsername').addClass('has-danger')\r\n                                        .removeClass('has-success');\r\n                }\r\n            }\r\n        });\r\n    }\r\n\r\n    checkPasswordStrength() {\r\n        let passWord = $('#password').val();\r\n        let strengthPourcent = 0;\r\n        let addPourcentComplete = 100 / 3;\r\n        if (passWord.length >= 5) {\r\n            strengthPourcent += addPourcentComplete;\r\n        }\r\n\r\n        if (passWord !== passWord.toLowerCase()) {\r\n            strengthPourcent += addPourcentComplete;\r\n        }\r\n\r\n        // Find special chars\r\n        let regexSpecialChars = '!@#$%^&*()+=-[]\\';,./{}|\":<>?~_';\r\n        let hasSpecialChar = false;\r\n        for (let i = 0; i < passWord.length; i++) {\r\n            if (regexSpecialChars.indexOf(passWord[i]) !== -1) {\r\n                hasSpecialChar = true;\r\n                break;\r\n            }\r\n        }\r\n\r\n        if (hasSpecialChar) {\r\n            strengthPourcent += addPourcentComplete;\r\n        }\r\n        $('#passStrengthProgress').attr('value', strengthPourcent);\r\n    }\r\n\r\n    generateCaptcha() {\r\n        let tmpIndex = Math.floor((Math.random() * 3) + 1);\r\n        tmpIndex--;\r\n        this.selectedOpCaptcha = this.tabOpCaptcha[tmpIndex];\r\n        this.fNumCaptcha = Math.floor((Math.random() * 10) + 1);\r\n        this.sNumCaptcha = Math.floor((Math.random() * 10) + 1);\r\n        if (this.selectedOpCaptcha === '-') {\r\n            // If the first number is lower than the second one we switch the numbers\r\n            if (this.fNumCaptcha < this.sNumCaptcha) {\r\n                let tmp = this.fNumCaptcha;\r\n                this.fNumCaptcha = this.sNumCaptcha;\r\n                this.sNumCaptcha = tmp;\r\n            }\r\n        }\r\n\r\n        // Update spans\r\n        $('#firstNumberCaptcha').html(this.fNumCaptcha);\r\n        $('#opCaptcha').html(this.selectedOpCaptcha);\r\n        $('#secondNumberCaptcha').html(this.sNumCaptcha);\r\n    }\r\n\r\n    // Private\r\n    _validForm() {\r\n        let username = $('#username').val();\r\n        let email = $('#email').val();\r\n        let password = $('#password').val();\r\n        let password2 = $('#password2').val();\r\n        let tabErr = [];\r\n        if (username.length === 0) {\r\n            tabErr.push('#formGpUsername');\r\n        }\r\n\r\n        if (password.length === 0 || password !== password2) {\r\n            tabErr.push('#formGpPassword');\r\n        }\r\n\r\n        let regexMail = /^([\\w-]+(?:\\.[\\w-]+)*)@((?:[\\w-]+\\.)*\\w[\\w-]{0,66})\\.([a-z]{2,6}(?:\\.[a-z]{2})?)$/i;\r\n        if (email.length === 0 || !regexMail.test(email)) {\r\n            tabErr.push('#formGpEmail');\r\n        }\r\n\r\n        if (!this._checkCaptchaResult()) {\r\n            tabErr.push('#formGpCaptcha');\r\n        }\r\n        return tabErr;\r\n    }\r\n\r\n    _checkCaptchaResult() {\r\n        let userResult = $('#inputCaptcha').val();\r\n        if (userResult.length === 0) {\r\n            return false;\r\n        }\r\n\r\n        userResult = parseInt(userResult, 10);\r\n        if (isNaN(userResult)) {\r\n            return false;\r\n        }\r\n\r\n        let result = 0;\r\n        switch (this.selectedOpCaptcha) {\r\n            case '+':\r\n                result = this.fNumCaptcha + this.sNumCaptcha;\r\n                break;\r\n            case '-':\r\n                result = this.fNumCaptcha - this.sNumCaptcha;\r\n                break;\r\n            case 'x':\r\n                result = this.fNumCaptcha * this.sNumCaptcha;\r\n                break;\r\n            default:\r\n                result = this.fNumCaptcha + this.sNumCaptcha;\r\n                break;\r\n        }\r\n\r\n        return result === userResult;\r\n    }\r\n\r\n    _sendRequest() {\r\n        let formData = this._getFormData();\r\n        $('#btnSubmit').addClass('disabled');\r\n        $('.own-loader').show();\r\n        $.ajax({\r\n            type: 'POST',\r\n            url: $('#registrationForm').attr('action'),\r\n            data: formData,\r\n            success: this._registerSuccess,\r\n            error: this._registerError\r\n        });\r\n    }\r\n\r\n    _registerSuccess(response) {\r\n        $('.own-loader').hide();\r\n        if (response.result) {\r\n            $('#cardForm').remove();\r\n            $('#registerAlertSuccess').show();\r\n        }\r\n        else {\r\n            $('#btnSubmit').removeClass('disabled');\r\n            $('#registerAlertError').show();\r\n        }\r\n    }\r\n\r\n    _registerError() {\r\n        $('.own-loader').hide();\r\n        $('#btnSubmit').removeClass('disabled');\r\n        $('#registerAlertError').show();\r\n    }\r\n\r\n    _getFormData() {\r\n        return {\r\n            type: 'registration',\r\n            login: $('#username').val(),\r\n            email: $('#email').val(),\r\n            password: $('#password').val()\r\n        };\r\n    }\r\n\r\n    _addError(tabError) {\r\n        $(tabError).each((i) => {\r\n            $(tabError[i]).addClass('has-danger');\r\n            $(tabError[i]).find('input').addClass('form-control-danger');\r\n        });\r\n    }\r\n\r\n    _removeError() {\r\n        $('.form-group.has-danger').removeClass('has-danger');\r\n        $('.form-group.has-success').removeClass('has-success');\r\n        $('input .form-control-danger').removeClass('form-control-danger');\r\n        $('input .form-control-success').removeClass('form-control-success');\r\n    }\r\n}\r\n\r\n$(document).ready(() => {\r\n    new Registration();\r\n});\r\n"]}